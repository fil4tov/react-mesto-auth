"use strict";(self.webpackChunkmesto_react=self.webpackChunkmesto_react||[]).push([[932],{4538:function(e,n,t){t.d(n,{G:function(){return p},I:function(){return c}});var r=t(1413),a=t(4942),i=t(4925),s=t(2791),o=t(1600),u=t(184),l=["className","inverted","error","errorMessage"],c=s.forwardRef((function(e,n){var t,s=e.className,c=e.inverted,d=e.error,p=e.errorMessage,f=(0,i.Z)(e,l);return(0,u.jsxs)("label",{className:(0,o.A)(["text-field",s]),children:[(0,u.jsx)("input",(0,r.Z)({ref:n,className:(0,o.A)(["text-field__input"],(t={},(0,a.Z)(t,"text-field__input_type_error",d),(0,a.Z)(t,"text-field__input_type_inverted",c),t))},f)),(0,u.jsx)("span",{className:"text-field__error",children:p})]})})),d=["inverted","className","children"],p=function(e){var n=e.inverted,t=e.className,s=e.children,l=(0,i.Z)(e,d);return(0,u.jsx)("button",(0,r.Z)((0,r.Z)({className:(0,o.A)(["button button__submit",t],(0,a.Z)({},"button__submit_type_inverted",n))},l),{},{children:s}))}},2743:function(e,n,t){t.d(n,{BF:function(){return u},WO:function(){return i},UQ:function(){return o},V$:function(){return s}});var r=t(9439),a=t(2791),i=function(e,n){var t=a.useState(e),i=(0,r.Z)(t,2),s=i[0],o=i[1];a.useEffect((function(){e&&o(!0)}),[e]);var u=function(e){"Escape"===e.key&&n()};return a.useEffect((function(){return e&&document.addEventListener("keydown",u),function(){return document.removeEventListener("keydown",u)}}),[e]),{handleCloseOnOverlay:function(e){e.target.classList.contains("popup")&&n()},onAnimationEnd:function(){e||o(!1)},isVisible:s}},s=function(e){var n=a.useState(e),t=(0,r.Z)(n,2),i=t[0],s=t[1],o=a.useState(""),u=(0,r.Z)(o,2),l=u[0],c=u[1],d=a.useState(!1),p=(0,r.Z)(d,2),f=p[0],m=p[1],x=a.useRef(null),b=function(){x.current&&!x.current.validity.valid?(c(x.current.validationMessage),m(!1)):(c(""),m(!0))};return{value:i,onChange:function(e){s(e.target.value),b()},clear:function(){s(""),m(!1),c("")},set:function(e){s(e),b()},ref:x,error:l,isValid:f}},o=function(e){var n=e.initialText,t=e.inputsValidity,i=a.useState(!1),s=(0,r.Z)(i,2),o=s[0],u=s[1],l=a.useState(n),c=(0,r.Z)(l,2);return{setIsLoading:u,buttonText:c[0],setButtonText:c[1],isSubmitDisabled:t.some((function(e){return!e}))||o}},u=function(e){var n=e.initialIsOpen,t=a.useState(n),i=(0,r.Z)(t,2),s=i[0],o=i[1];return{isOpen:s,open:function(){return o(!0)},close:function(){return o(!1)}}}},4932:function(e,n,t){t.r(n),t.d(n,{default:function(){return N}});var r=t(1413),a=t(4165),i=t(5861),s=t(9439),o=t(2791),u=t(4942),l=t(2743),c=t(1600),d=t(4538),p=t(184),f=function(e){var n=e.name,t=e.title,r=e.buttonText,a=e.children,i=e.isOpen,s=e.onClose,o=e.onSubmit,f=e.isSubmitDisabled,m=(0,l.WO)(i,s),x=m.handleCloseOnOverlay,b=m.onAnimationEnd,v=m.isVisible;return(0,p.jsx)(p.Fragment,{children:v&&(0,p.jsx)("div",{onMouseDown:x,onAnimationEnd:b,className:(0,c.A)(["popup","popup_type_".concat(n)],(0,u.Z)({},"popup_opened",i)),children:(0,p.jsxs)("div",{className:"popup__container",children:[(0,p.jsx)("h2",{className:"popup__title",children:t}),(0,p.jsxs)("form",{onSubmit:o,name:n,className:"popup__form",autoComplete:"off",children:[a,(0,p.jsx)(d.G,{disabled:f,type:"submit","aria-label":r,children:r})]}),(0,p.jsx)("button",{onClick:s,className:"button popup__close",type:"button","aria-label":"\u0417\u0430\u043a\u0440\u044b\u0442\u044c \u043c\u043e\u0434\u0430\u043b\u044c\u043d\u043e\u0435 \u043e\u043a\u043d\u043e"})]})})})},m=t(4667),x=function(e){var n,t,r=e.isOpen,a=e.onClose,i=e.onSubmit,s=o.useContext(m.Ec),u=s.currentUser,c=s.setCurrentUser,x=(0,l.V$)(""),b=(0,l.V$)(""),v=(0,l.UQ)({initialText:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",inputsValidity:[x.isValid,b.isValid]}),_=v.setIsLoading,h=v.buttonText,C=v.setButtonText,j=v.isSubmitDisabled;o.useEffect((function(){x.set(u.name),b.set(u.about)}),[u,r]);return o.useEffect((function(){r&&setTimeout((function(){x.ref.current.focus()}),100)}),[r]),(0,p.jsxs)(f,{name:"edit",title:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c",buttonText:h,isOpen:r,onClose:a,onSubmit:function(e){e.preventDefault(),_(!0),C("\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435..."),i({name:x.value,about:b.value}).then((function(e){c(e),a()})).catch(console.log).finally((function(){_(!1),C("\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c")}))},isSubmitDisabled:j,children:[(0,p.jsx)(d.I,{value:null!==(n=x.value)&&void 0!==n?n:"",onChange:x.onChange,ref:x.ref,error:Boolean(x.error),errorMessage:x.error,type:"text",placeholder:"\u0418\u043c\u044f",minLength:"2",maxLength:"40",required:!0}),(0,p.jsx)(d.I,{className:"popup__field",value:null!==(t=b.value)&&void 0!==t?t:"",onChange:b.onChange,ref:b.ref,error:Boolean(b.error),errorMessage:b.error,type:"text",placeholder:"\u041e \u0441\u0435\u0431\u0435",minLength:"2",maxLength:"200",required:!0})]})},b=function(e){var n=e.isOpen,t=e.onClose,r=e.onSubmit,a=o.useContext(m.Ec).setCurrentUser,i=(0,l.V$)(""),s=(0,l.UQ)({initialText:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",inputsValidity:[i.isValid]}),u=s.setIsLoading,c=s.buttonText,x=s.setButtonText,b=s.isSubmitDisabled,v=function(){i.clear(),t()};return o.useEffect((function(){n&&setTimeout((function(){i.ref.current.focus()}),100)}),[n]),(0,p.jsx)(f,{name:"avatar",title:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440",buttonText:c,isOpen:n,onClose:v,isSubmitDisabled:b,onSubmit:function(e){e.preventDefault(),u(!0),x("\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435..."),r({avatar:i.value}).then((function(e){a(e),v()})).catch(console.log).finally((function(){u(!1),x("\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c")}))},children:(0,p.jsx)(d.I,{className:"popup__field",value:i.value,onChange:i.onChange,ref:i.ref,error:Boolean(i.error),errorMessage:i.error,type:"url",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u0430\u0432\u0430\u0442\u0430\u0440",required:!0})})},v=t(3433),_=function(e){var n=e.isOpen,t=e.onClose,r=e.onSubmit,a=e.cards,i=e.setCards,s=(0,l.V$)(""),u=(0,l.V$)(""),c=(0,l.UQ)({initialText:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c",inputsValidity:[s.isValid,u.isValid]}),m=c.setIsLoading,x=c.buttonText,b=c.setButtonText,_=c.isSubmitDisabled,h=function(){s.clear(),u.clear(),t()};return o.useEffect((function(){n&&setTimeout((function(){s.ref.current.focus()}),100)}),[n]),(0,p.jsxs)(f,{name:"add",title:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043f\u043e\u0441\u0442",buttonText:x,isOpen:n,onClose:h,onSubmit:function(e){e.preventDefault(),m(!0),b("\u0421\u043e\u0437\u0434\u0430\u043d\u0438\u0435..."),r({link:u.value,name:s.value}).then((function(e){i([e].concat((0,v.Z)(a))),h()})).catch(console.log).finally((function(){m(!1),b("\u0421\u043e\u0437\u0434\u0430\u0442\u044c")}))},isSubmitDisabled:_,children:[(0,p.jsx)(d.I,{value:s.value,onChange:s.onChange,ref:s.ref,error:Boolean(s.error),errorMessage:s.error,type:"text",placeholder:"\u041c\u0435\u0441\u0442\u043e",minLength:"2",maxLength:"30",required:!0}),(0,p.jsx)(d.I,{className:"popup__field",value:u.value,onChange:u.onChange,ref:u.ref,error:Boolean(u.error),errorMessage:u.error,type:"url",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",required:!0})]})},h=function(e){var n=e.isOpen,t=e.onClose,r=e.onSubmit,a=e.cardId,i=e.cards,s=e.setCards,o=(0,l.UQ)({initialText:"\u0414\u0430",inputsValidity:[]}),u=o.setIsLoading,c=o.buttonText,d=o.setButtonText,m=o.isSubmitDisabled;return(0,p.jsx)(f,{title:"\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b?",buttonText:c,isOpen:n,onClose:t,onSubmit:function(e){e.preventDefault(),u(!0),d("\u0423\u0434\u0430\u043b\u0435\u043d\u0438\u0435..."),r(a).then((function(){s(i.filter((function(e){return e._id!==a}))),t()})).catch(console.log).finally((function(){u(!1),d("\u0414\u0430")}))},isSubmitDisabled:m})},C=function(e){var n=e.link,t=e.name,r=e.isOpen,a=e.onClose,i=(0,l.WO)(r,a),s=i.handleCloseOnOverlay,o=i.onAnimationEnd,d=i.isVisible;return(0,p.jsx)(p.Fragment,{children:d&&(0,p.jsx)("div",{onClick:s,onAnimationEnd:o,className:(0,c.A)(["popup","popup_type_image","popup_dark"],(0,u.Z)({},"popup_opened",r)),children:Boolean(r)&&(0,p.jsxs)("div",{className:"popup__container popup__container_image",children:[(0,p.jsx)("img",{className:"popup__full-screen-image",src:n,alt:t}),(0,p.jsx)("p",{className:"popup__location",children:t}),(0,p.jsx)("button",{onClick:a,className:"button popup__close",type:"button","aria-label":"\u0417\u0430\u043a\u0440\u044b\u0442\u044c \u043c\u043e\u0434\u0430\u043b\u044c\u043d\u043e\u0435 \u043e\u043a\u043d\u043e"})]})})})},j=function(e){var n=e.text,t=e.error;return(0,p.jsxs)("div",{children:[(0,p.jsx)("h3",{children:n}),(0,p.jsx)("h4",{children:t})]})},g=o.memo((function(e){var n=e._id,t=e.name,r=e.link,a=e.likes,i=e.owner,s=e.onImageClick,l=e.onCardLike,d=e.onCardDelete,f=o.useContext(m.Ec).currentUser,x=f._id===i._id,b=a.some((function(e){return e._id===f._id}));return(0,p.jsxs)("div",{className:"card",children:[(0,p.jsx)("img",{onClick:function(){s({name:t,link:r})},src:r,alt:t,className:"card__photo"}),(0,p.jsxs)("div",{className:"card__description",children:[(0,p.jsx)("h2",{className:"card__location",children:t}),(0,p.jsxs)("div",{className:"card__like",children:[(0,p.jsx)("button",{onClick:function(){l(b,n)},className:(0,c.A)(["button card__like-button"],(0,u.Z)({},"card__like-button_active",b)),type:"button","aria-label":"\u041f\u043e\u0441\u0442\u0430\u0432\u0438\u0442\u044c \u043b\u0430\u0439\u043a"}),(0,p.jsx)("p",{className:"card__likes",children:a.length})]})]}),x&&(0,p.jsx)("button",{onClick:function(){d(n)},className:"button card__delete-button",type:"button","aria-label":"\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u043f\u043e\u0441\u0442"})]})})),Z=function(e){var n=e.onEditProfile,t=e.onAddPlace,a=e.onEditAvatar,i=e.cards,s=e.cardProps,u=o.useContext(m.Ec).currentUser,l=u.name,c=u.avatar,d=u.about;return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)("section",{className:"profile",children:[(0,p.jsxs)("div",{onClick:a,className:"profile__avatar-container",children:[(0,p.jsx)("img",{className:"profile__avatar",src:c,alt:"\u0410\u0432\u0430\u0442\u0430\u0440\u043a\u0430"}),(0,p.jsx)("div",{className:"profile__avatar-edit"})]}),(0,p.jsxs)("div",{className:"profile__info",children:[(0,p.jsx)("h1",{className:"profile__name",children:l}),(0,p.jsx)("button",{onClick:n,className:"button profile__edit-button",type:"button","aria-label":"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c"}),(0,p.jsx)("p",{className:"profile__description",children:d})]}),(0,p.jsx)("button",{onClick:t,className:"button profile__add-button",type:"button","aria-label":"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043f\u043e\u0441\u0442"})]}),(0,p.jsx)("section",{className:"gallery","aria-label":"\u041f\u043e\u0441\u0442\u044b \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f",children:i.map((function(e){return(0,p.jsx)(g,(0,r.Z)((0,r.Z)({},e),s),e._id)}))})]})},k=t(6713),N=function(){var e=(0,l.BF)({initialIsOpen:!1}),n=(0,l.BF)({initialIsOpen:!1}),t=(0,l.BF)({initialIsOpen:!1}),u=(0,l.BF)({initialIsOpen:!1}),c=(0,l.BF)({initialIsOpen:!1}),d=o.useState({}),f=(0,s.Z)(d,2),m=f[0],v=f[1],g=o.useState(""),N=(0,s.Z)(g,2),y=N[0],O=N[1],S=o.useState([]),E=(0,s.Z)(S,2),T=E[0],I=E[1],V=o.useState(""),D=(0,s.Z)(V,2),L=D[0],B=D[1];o.useEffect((function(){k.Z.getInitialCards().then(I).catch(B)}),[]);var A=function(){var e=(0,i.Z)((0,a.Z)().mark((function e(n){var t,r;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.name,r=n.about,e.next=3,k.Z.updateUserInfo({name:t,about:r});case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),w=function(){var e=(0,i.Z)((0,a.Z)().mark((function e(n){var t,r;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.name,r=n.link,e.next=3,k.Z.addCard({name:t,link:r});case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),U=function(){var e=(0,i.Z)((0,a.Z)().mark((function e(n){var t;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.avatar,e.next=3,k.Z.updateAvatar({avatar:t});case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),F=function(){var e=(0,i.Z)((0,a.Z)().mark((function e(n){return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k.Z.deleteCard(n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),M=o.useCallback((function(e){u.open(),O(e)}),[]),P=o.useCallback((function(e){var n=e.name,t=e.link;c.open(),v({name:n,link:t})}),[]),$={onCardDelete:M,onCardLike:o.useCallback((function(e,n){k.Z.toggleLike(n,e?"DELETE":"PUT").then((function(e){I(T.map((function(t){return t._id===n?e:t})))})).catch(console.log)}),[T]),onImageClick:P};return L?(0,p.jsx)(p.Fragment,{children:(0,p.jsx)(j,{text:"\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u043a\u0430\u0440\u0442\u043e\u0447\u043a\u0438",error:L})}):(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(Z,{onAddPlace:e.open,onEditAvatar:t.open,onEditProfile:n.open,cards:T,cardProps:$}),(0,p.jsx)(x,{isOpen:n.isOpen,onClose:n.close,onSubmit:A}),(0,p.jsx)(b,{isOpen:t.isOpen,onClose:t.close,onSubmit:U}),(0,p.jsx)(_,{isOpen:e.isOpen,onClose:e.close,onSubmit:w,cards:T,setCards:I}),(0,p.jsx)(h,{isOpen:u.isOpen,onClose:u.close,onSubmit:F,cardId:y,cards:T,setCards:I}),(0,p.jsx)(C,(0,r.Z)({isOpen:c.isOpen,onClose:c.close},m))]})}}}]);
//# sourceMappingURL=932.72456ed7.chunk.js.map